# 几种依赖注入模式的对比总结

接口注入模式因为历史较为悠久，在很多容器中都已经得到应用。但由于其在灵活性、易用性上不如其他两种注入模式，因而在 IOC 的专题世界内并不被看好。

设值方法注入和构造子注入型的依赖注入实现则是目前主流的 IOC 实现模式。这两种实现方式各有特点，也各具优势。

## 设值注入的优势

- 对于习惯了传统 JavaBean 开发的程序员而言，通过`setter`方法设定依赖关系显得更加直观，更加自然。
- 如果依赖关系（或继承关系）较为复杂，那么构造子注入模式的构造函数也会相当庞大（我们需要在构造函数中设定所有依赖关系），此时设值方法注入模式往往更为简洁。
- 对于某些第三方类库而言，可能要求我们的组件必须提供一个默认的构造函数（如 Struts 中的 Action），此时构造子注入类型的依赖注入机制就体现出其局限性，难以完成我们期望的功能。

## 构造子注入的优势

- “在构造期即创建一个完整、合法的对象”，对于这条 Java 设计原则，构造子注入无疑是最好的响应者。
- 避免了繁琐的`setter`方法的编写，所有依赖关系均在构造函数中设定，依赖关系集中呈现，更加易读。
- 由于没有`setter`方法，依赖关系在构造时由容器一次性设定，因此组件在被创建之后即处于相对“不变”的稳定状态，无需担心上层代码在调用过程中执行`setter`方法对组件依赖关系产生破坏，特别是对于`Singleton`模式的组件而言，这可能对整个系统产生重大的影响。
- 同样，由于关联关系仅在构造函数中表达，只有组件创建者需要关心组件内部的依赖关系。对调用者而言，组件中的依赖关系处于黑盒之中。对上层屏蔽不必要的信息，也为系统的层次清晰性提供了保证。
- 通过构造子注入，意味着我们可以在构造函数中决定依赖关系的注入顺序，对于一个大量依赖外部服务的组件而言，依赖关系的获得顺序可能非常重要，比如某个依赖关系注入的先决条件是组件的`UserDao`及相关资源已经被设定。

可见，构造子注入和设值注入模式各有千秋，而 Spring、PicoContainer 都对构造子注入和设值注入类型的依赖注入机制提供了良好支持。这也就为我们提供了更多的选择余地。理论上，以构造子注入类型为主，辅之以设值注入类型机制作为补充，可以达到最好的依赖注入效果，不过对于基于 Spring Framework 开发的应用而言，设值注入使用更加广泛。
